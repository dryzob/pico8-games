pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- main functions

function _init()
	cls()
	palt(0, false)
	palt(3, true)
	-- later will have rng
end

function _update()
	uvamp()

end

function _draw()
	--cls()
	map()
	dvamp()
end

-->8
-- vampire

function dvamp()
	spr(vamp.sprite,vamp.x,vamp.y)
	
end

function uvamp()
	move(vamp)
	
	if btn(❎) then
		if hit(vamp.x-vamp.range,vamp.y-vamp.range,
						vamp.w+2*vamp.range,vamp.h+2*vamp.range,inct) then
			print("it worked")
		end
	end
	if btn(🅾️) then
		print("")
	end
end
-->8
-- gemeral functions

wall=0x99
inct=0x20

function hit(x,y,w,h,col)
	local collide=false
	
	for i=x,x+w do
		if((fget(mget(i/8,y/8))&col)==col)or
			((fget(mget(i/8,(y+h)/8))&col)==col)then
		 	collide=true
		end
	end
	
	for i=y,y+h do
  if((fget(mget(x/8,i/8))&col)==col)or
   ((fget(mget((x+w)/8,i/8))&col)==col)then
    collide=true
  end
 end
 return collide
end

function move(act)
	local dx=0
	local dy=0

	if(btn(⬅️)) dx -= act.spe
	if(btn(➡️)) dx += act.spe
	if(btn(⬆️)) dy -= act.spe
	if(btn(⬇️)) dy += act.spe
	
	-- colision
	if hit(act.x+dx,act.y,
					act.w,act.h,wall) then
		dx=0
	end
	if hit(act.x,act.y+dy,
					act.w,act.h,wall) then
		dy=0
	end
	
	act.x+=dx
	act.y+=dy
end
-->8
-- actors
vamp={
	x=0,
	y=0,
	w=5,
	h=7,
	spe=1,
	sprite=1,
	health=3,
	dmg=1,
	range=4
}

citizen={
	x=0,
	y=0,
	w=5,
	h=7,
	spe=1,
	sprite=2,
	health=4,
	val=1
}

doug={
	x=0,
	y=0,
	w=5,
	h=7,
	spe=1,
	health=4,
	sprite=3,
	hat1=18,
	hat2=19,
	mon=1,
}

cop={
	x=0,
	y=0,
	w=5,
	h=7,
	spe=1,
	sprite=4,
	health=8,
	dmg=2,
	val=2
}

mayor={
	x=0,
	y=0,
	w=5,
	h=7,
	spe=1,
	sprite=2,
	health=4,
	val=1
}
-->8
--objects
door={
	x=0,
	y=0,
	sprite={69,70},
	state=0
}

function ocdoor(x,y)
	if 
__gfx__
0000000030000033344444337777773331116133e322333330000333000000003333333333333333333333333373333333000003333333330000000000000000
0000000007c7c3334f0f03333f0f0333340f03432e2222333cccc333000000003333333333333333333883333733777330080833333823330000000000000000
00700700377773333ffff3333f6663333f4ee4333f0f033300000033000000003333333333379333333883337337333733000033333823330000000000000000
0007700000686033111911337700073311111133224442333f2f23330000000033444433337aa933338788337773777330000003388888230000000000000000
000770000008003311191133777077331111a133222422333ffff333000000003444444333aaa933387888837777333730000003388888230000000000000000
0070070070080733f1191f33f0aa0f33f6611f33f0090f33000c003300000000300aa00333aaa933388888237777773330000003333823330000000000000000
000000003000033331111333377773333000033332222333f00c0f3300000000344aa443333a9333338882333333337333000033333823330000000000000000
00000000303303333033033330330333313313333033033330330333000000003444444333333333333333333333333333033033333333330000000000000000
00000000000000003777733333773333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003777733337777333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003777733337777333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003777733337777333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003777733337777333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003777733337777333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003777733337777333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003aaaa33337777333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65666656333003333333333300000000888858888444444880000008000000000000000000000000000000000000000000000000000000000000000000000000
6666666633300333333003330000000088885888a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
6666666533300333330000330000000088885888a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
5666656633300333333a9333000000005555555544444aa400000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666333003333339a333000000008858888844444aa400000000000000000000000000000000000000000000000000000000000000000000000000000000
66566666333003333330033300000000885888884444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
5666666633000033333003330000000088588888a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
6666656630000003333003330000000055555555a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
66656666000000000000000000000000dddd1ddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dd1ddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66656665000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddd1d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001020202220200200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000406020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
5040504040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505050504050405040404040505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4050505040505040505050505050405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5040405040504444444444505040504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4050505050404454545444504040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4050504050404454545444404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505040504454545444504050405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5040405040404454545444404050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5040404050404444454444405050405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5050404040504050504040405040405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040405040504040505050505050404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505040405050404040404050404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505040405040504040504050504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040505040505050404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00000000081500c1500e150101501215013150131501415012150111500f1500d1500b15009150091500c1500f15013150161501b1501c1501d1501d1501d1501c15019150141500c15008150062000110000000
0008000015750267500f7502c750317501a750047501a75022750067503675026750167500b750237501e75018750237500f7500e75009750137502f750207501d75021750277501e7501b75016750117500a750
