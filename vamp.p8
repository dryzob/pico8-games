pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- main functions

debug=false

function _init()
	cls()
	palt(0, false)
	palt(3, true)
	-- later will have rng
end

function _update()
	uvamp()

end

function _draw()
	--cls()
	map()
	dvamp()
end

-->8
-- vampire
vamp={
	x=0,
	y=0,
	spe=1,
	sprite=1,
}

function dvamp()
	spr(vamp.sprite,vamp.x,vamp.y)
	
	if debug then
	 local x1=vamp.x
	 local y1=vamp.y
	 local x2=(vamp.x+7)
	 local y2=(vamp.y+7)
	
	 rect(x1,y1,x2,y2,9)
	end
	
end

function uvamp()
	move(vamp)
end
-->8
-- helper functions

wall=6
inct=5

-- todo: fix cornering
function colision(obj,col)
	local x1=(obj.x+1)/8
	local y1=(obj.y+5)/8
	local x2=(obj.x+6)/8
	local y2=(obj.y+7)/8
	
	local a=fget(mget(x1,y1),col)
	local b=fget(mget(x1,y2),col)
	local c=fget(mget(x2,y2),col)
	local d=fget(mget(x2,y1),col)
	
	-- y
	if (a and d) or (b and c) then
	 return 1
	-- x
	elseif (a and b) or (c and d) then 
		return 2
	-- no collision
	else 
		return 0
	end
end

function move(act)
	--last pos
	local lx=act.x
	local ly=act.y

	if(btn(⬅️)) act.x -= act.spe
	if(btn(➡️)) act.x += act.spe
	if(btn(⬆️)) act.y -= act.spe
	if(btn(⬇️)) act.y += act.spe
	
	-- colision
	local dir=colision(act,wall)
	if dir == 2 then
		act.x=lx
	end
	if dir == 1 then
		act.y=ly
	end
end
__gfx__
00000000330000033344444337777773331116133e32233333000033000000003333333333333333333333333373333333000003333333330000000000000000
00000000307c7c3334f0f03333f0f0333340f03432e2222333cccc33000000003333333333333333333883333733777330080833333823330000000000000000
007007003377773333ffff3333f6663333f4ee4333f0f03330000003000000003333333333379333333883337337333733000033333823330000000000000000
00077000300686033111911337700073311111133224442333f2f2330000000033444433337aa933338788337773777330000003388888230000000000000000
0007700030008003311191133777077331111a133222422333ffff33000000003444444333aaa933387888837777333730000003388888230000000000000000
00700700370080733f1191f33f0aa0f33f6611f33f0090f33000c00300000000300aa00333aaa933388888237777773330000003333823330000000000000000
0000000033000033331111333377773333000033332222333f00c0f300000000344aa443333a9333338882333333337333000033333823330000000000000000
00000000330330333303303333033033331331333303303333033033000000003444444333333333333333333333333333033033333333330000000000000000
00000000000000003377773333377333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003377773333777733000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003377773333777733000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003377773333777733000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003377773333777733000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003377773333777733000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003377773333777733000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000033aaaa3333777733000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65666656333003333333333300000000888858888444444880000008000000000000000000000000000000000000000000000000000000000000000000000000
6666666633300333333003330000000055555555a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
6666666533300333330000330000000085888858a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
5666656633300333333a9333000000008588885844444aa400000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666333003333339a333000000005555555544444aa400000000000000000000000000000000000000000000000000000000000000000000000000000000
66566666333003333330033300000000888588884444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
5666666633000033333003330000000088858888a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
6666656630000003333003330000000055555555a444444400000000000000000000000000000000000000000000000000000000000000000000000000000000
66656666000000000000000000000000dddd1ddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dd1ddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66656665000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666000000000000000000000000dddddd1d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001020202020200200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
5040504040404040404040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505050504050405040404040505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4050505040505040505050505050405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5040405040504444444444505040504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4050505050404454545444504040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4050504050404454545444404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505040504454545444504050405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5040405040404454545444404050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5040404050404444454444405050405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5050404040504050504040405040405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040405040504040505050505050404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505040405050404040404050404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040505040405040504040504050504000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040505040505050404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
